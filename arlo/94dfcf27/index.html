<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"islocal.cc",root:"/",scheme:"Muse",version:"7.8.0",exturl:!1,sidebar:{position:"right",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"default"},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="监控oracle 12c2之前的版本，可以使用orabbix来实现，可参考：http:&#x2F;&#x2F;islocal.cc&#x2F;arlo&#x2F;780360a7&#x2F; Zabbix 5.4，支持使用Zabbix agent2 来监控12c2,18c,19c，官网文档：https:&#x2F;&#x2F;www.zabbix.com&#x2F;cn&#x2F;integrations&#x2F;oracle    角色 操作系统 主机名 IP地址    Zabbix Ser"><meta property="og:type" content="article"><meta property="og:title" content="zabbix(14) 使用Zabbix Agent2 监控Oracle 19c"><meta property="og:url" content="http://islocal.cc/arlo/94dfcf27/index.html"><meta property="og:site_name" content="南山草舍"><meta property="og:description" content="监控oracle 12c2之前的版本，可以使用orabbix来实现，可参考：http:&#x2F;&#x2F;islocal.cc&#x2F;arlo&#x2F;780360a7&#x2F; Zabbix 5.4，支持使用Zabbix agent2 来监控12c2,18c,19c，官网文档：https:&#x2F;&#x2F;www.zabbix.com&#x2F;cn&#x2F;integrations&#x2F;oracle    角色 操作系统 主机名 IP地址    Zabbix Ser"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://islocal.cc/images/2021/1116/01.png"><meta property="og:image" content="http://islocal.cc/images/2021/1116/02.png"><meta property="og:image" content="http://islocal.cc/images/2021/1116/03.png"><meta property="og:image" content="http://islocal.cc/images/2021/1116/04.png"><meta property="og:image" content="http://islocal.cc/images/2021/1116/05.png"><meta property="article:published_time" content="2021-11-16T01:49:33.000Z"><meta property="article:modified_time" content="2022-12-21T13:40:50.077Z"><meta property="article:author" content="南山小樵"><meta property="article:tag" content="zabbix"><meta property="article:tag" content="监控"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://islocal.cc/images/2021/1116/01.png"><link rel="canonical" href="http://islocal.cc/arlo/94dfcf27/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>zabbix(14) 使用Zabbix Agent2 监控Oracle 19c | 南山草舍</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">南山草舍</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">17</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">180</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">104</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://islocal.cc/arlo/94dfcf27/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="南山小樵"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="南山草舍"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">zabbix(14) 使用Zabbix Agent2 监控Oracle 19c</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-11-16 09:49:33" itemprop="dateCreated datePublished" datetime="2021-11-16T09:49:33+08:00">2021-11-16</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-12-21 21:40:50" itemprop="dateModified" datetime="2022-12-21T21:40:50+08:00">2022-12-21</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E7%9B%91%E6%8E%A7/" itemprop="url" rel="index"><span itemprop="name">监控</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>监控oracle 12c2之前的版本，可以使用orabbix来实现，可参考：<a href="http://islocal.cc/arlo/780360a7/">http://islocal.cc/arlo/780360a7/</a></p><p>Zabbix 5.4，支持使用Zabbix agent2 来监控12c2,18c,19c，官网文档：<a target="_blank" rel="noopener" href="https://www.zabbix.com/cn/integrations/oracle">https://www.zabbix.com/cn/integrations/oracle</a></p><table><thead><tr><th>角色</th><th>操作系统</th><th>主机名</th><th>IP地址</th></tr></thead><tbody><tr><td>Zabbix Server</td><td>CentOS Linux release 8.4.2105</td><td>s1</td><td>192.168.111.128</td></tr><tr><td>Zabbix agent2+Oracle服务器+Oracle Client</td><td>CentOS Linux release 7.9.2009 (Core)</td><td>db132</td><td>192.168.111.132</td></tr></tbody></table><span id="more"></span><h1 id="1-安装Zabbix-Agent2"><a href="#1-安装Zabbix-Agent2" class="headerlink" title="1. 安装Zabbix Agent2"></a>1. 安装Zabbix Agent2</h1><h2 id="1-1-安装Zabbix-Agent2"><a href="#1-1-安装Zabbix-Agent2" class="headerlink" title="1.1 安装Zabbix Agent2"></a>1.1 安装Zabbix Agent2</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh http://pub.mirrors.aliyun.com/zabbix/zabbix/5.4/rhel/7/x86_64/zabbix-agent2-5.4.7-1.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><h2 id="1-2-修改zabbix-agent2-conf-配置文件"><a href="#1-2-修改zabbix-agent2-conf-配置文件" class="headerlink" title="1.2 修改zabbix_agent2.conf 配置文件"></a>1.2 修改zabbix_agent2.conf 配置文件</h2><p>修改Server和Hostname即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@db132 ~]# egrep -v &quot;^$|#&quot; /etc/zabbix/zabbix_agent2.conf </span><br><span class="line">PidFile=/var/run/zabbix/zabbix_agent2.pid</span><br><span class="line">LogFile=/var/log/zabbix/zabbix_agent2.log</span><br><span class="line">LogFileSize=0</span><br><span class="line">Server=192.168.111.128  #zabbix server 服务器地址</span><br><span class="line">ServerActive=127.0.0.1</span><br><span class="line">Hostname=db132    #本机主机名</span><br><span class="line">Include=/etc/zabbix/zabbix_agent2.d/*.conf</span><br><span class="line">ControlSocket=/tmp/agent.sock</span><br></pre></td></tr></table></figure><h2 id="1-3-启动zabbix-agent2"><a href="#1-3-启动zabbix-agent2" class="headerlink" title="1.3 启动zabbix-agent2"></a>1.3 启动zabbix-agent2</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start zabbix-agent2</span><br><span class="line">systemctl enable zabbix-agent2</span><br><span class="line">systemctl status zabbix-agent2</span><br></pre></td></tr></table></figure><h1 id="2-配置Oracle数据库"><a href="#2-配置Oracle数据库" class="headerlink" title="2. 配置Oracle数据库"></a>2. 配置Oracle数据库</h1><p>Oracle 12c开始，数据库分为CDB和PDB，CDB为容器数据库，默认启动数据库启动就是CDB；PDB是和我们11g中使用的那种数据库，默认是MOUNTED状态， 需要手动启动，以下为启动过程。</p><h2 id="2-1-启动PDB"><a href="#2-1-启动PDB" class="headerlink" title="2.1 启动PDB"></a>2.1 启动PDB</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">[root@db132 ~]# su - oracle</span><br><span class="line">Last login: Tue Nov 16 10:39:15 CST 2021 on pts/0</span><br><span class="line">[oracle@db132 ~]$ sqlplus / as sysdba</span><br><span class="line"></span><br><span class="line">SQL*Plus: Release 19.0.0.0.0 - Production on Tue Nov 16 10:42:19 2021</span><br><span class="line">Version 19.3.0.0.0</span><br><span class="line"></span><br><span class="line">Copyright (c) 1982, 2019, Oracle.  All rights reserved.</span><br><span class="line"></span><br><span class="line">Connected to an idle instance.</span><br><span class="line"></span><br><span class="line">SQL&gt; startup</span><br><span class="line">ORACLE instance started.</span><br><span class="line"></span><br><span class="line">Total System Global Area 1660941720 bytes</span><br><span class="line">Fixed Size		    9135512 bytes</span><br><span class="line">Variable Size		  989855744 bytes</span><br><span class="line">Database Buffers	  654311424 bytes</span><br><span class="line">Redo Buffers		    7639040 bytes</span><br><span class="line">Database mounted.</span><br><span class="line">Database opened.</span><br><span class="line">SQL&gt; show pdbs;</span><br><span class="line"></span><br><span class="line">    CON_ID CON_NAME			  OPEN MODE  RESTRICTED</span><br><span class="line">---------- ------------------------------ ---------- ----------</span><br><span class="line">	 2 PDB$SEED			  READ ONLY  NO</span><br><span class="line">	 3 ORCLPDB			  MOUNTED</span><br><span class="line">-- 这里可以看到有两个pdb数据库，PDB$SEED是创建pdb的模板数据库，是只读状态，看到ORCLPDB是MOUNTED状态，</span><br><span class="line">SQL&gt; select name,open_mode from v$pdbs;  </span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">OPEN_MODE</span><br><span class="line">--------------------</span><br><span class="line">PDB$SEED</span><br><span class="line">READ ONLY</span><br><span class="line"></span><br><span class="line">ORCLPDB</span><br><span class="line">MOUNTED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SQL&gt; select name,open_mode from v$pdbs;  </span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">OPEN_MODE</span><br><span class="line">--------------------</span><br><span class="line">PDB$SEED</span><br><span class="line">READ ONLY</span><br><span class="line"></span><br><span class="line">ORCLPDB</span><br><span class="line">MOUNTED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SQL&gt;  alter session set container=ORCLPDB; </span><br><span class="line"></span><br><span class="line">Session altered.</span><br><span class="line"></span><br><span class="line">SQL&gt; alter pluggable database open;</span><br><span class="line"></span><br><span class="line">Pluggable database altered.</span><br><span class="line"></span><br><span class="line">SQL&gt; select name,open_mode from v$pdbs;</span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">OPEN_MODE</span><br><span class="line">--------------------</span><br><span class="line">ORCLPDB</span><br><span class="line">READ WRITE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SQL&gt; show pdbs;</span><br><span class="line"></span><br><span class="line">    CON_ID CON_NAME			  OPEN MODE  RESTRICTED</span><br><span class="line">---------- ------------------------------ ---------- ----------</span><br><span class="line">	 3 ORCLPDB			  READ WRITE NO</span><br><span class="line">-- 启动完成后只能看到一个ORCLPDB,状态为READ WRITE	 </span><br><span class="line">SQL&gt; </span><br></pre></td></tr></table></figure><h2 id="2-1-新建Oracle-监控账号"><a href="#2-1-新建Oracle-监控账号" class="headerlink" title="2.1 新建Oracle 监控账号"></a>2.1 新建Oracle 监控账号</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER zabbix_mon IDENTIFIED BY &lt;PASSWORD&gt;;  #创建一个用户/密码都为zabbix_mon的用户</span><br><span class="line">-- Grant access to the zabbix_mon user.</span><br><span class="line">#这里有个细节，官网给的视图授权语句里V后边是没有下划线_的执行报错，需要手动修改一下，以下为修改过的语句</span><br><span class="line">GRANT CONNECT, CREATE SESSION TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON DBA_TABLESPACE_USAGE_METRICS TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON DBA_TABLESPACES TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON DBA_USERS TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON SYS.DBA_DATA_FILES TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$ACTIVE_SESSION_HISTORY TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$ARCHIVE_DEST TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$ASM_DISKGROUP TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$DATABASE TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$DATAFILE TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$INSTANCE TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$LOG TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$OSSTAT TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$PGASTAT TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$PROCESS TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$RECOVERY_FILE_DEST TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$RESTORE_POINT TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$SESSION TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$SGASTAT TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$SYSMETRIC TO zabbix_mon;</span><br><span class="line">GRANT SELECT ON V_$SYSTEM_PARAMETER TO zabbix_mon;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2-3-查看监听状态"><a href="#2-3-查看监听状态" class="headerlink" title="2.3 查看监听状态"></a>2.3 查看监听状态</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[oracle@db132 ~]$ lsnrctl status</span><br><span class="line"></span><br><span class="line">LSNRCTL for Linux: Version 19.0.0.0.0 - Production on 16-NOV-2021 10:42:43</span><br><span class="line"></span><br><span class="line">Copyright (c) 1991, 2019, Oracle.  All rights reserved.</span><br><span class="line"></span><br><span class="line">Connecting to (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=db132)(PORT=1521)))</span><br><span class="line"></span><br><span class="line">STATUS of the LISTENER</span><br><span class="line"></span><br><span class="line">Alias                     LISTENER</span><br><span class="line">Version                   TNSLSNR for Linux: Version 19.0.0.0.0 - Production</span><br><span class="line">Start Date                16-NOV-2021 09:34:04</span><br><span class="line">Uptime                    0 days 1 hr. 8 min. 40 sec</span><br><span class="line">Trace Level               off</span><br><span class="line">Security                  ON: Local OS Authentication</span><br><span class="line">SNMP                      OFF</span><br><span class="line">Listener Parameter File   /u01/app/oracle/product/19.3.0/db_1/network/admin/listener.ora</span><br><span class="line">Listener Log File         /u01/app/oracle/diag/tnslsnr/db132/listener/alert/log.xml</span><br><span class="line">Listening Endpoints Summary...</span><br><span class="line">  (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=db132)(PORT=1521)))</span><br><span class="line">  (DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(KEY=EXTPROC1521)))</span><br><span class="line">  (DESCRIPTION=(ADDRESS=(PROTOCOL=tcps)(HOST=db132)(PORT=5500))(Security=(my_wallet_directory=/u01/app/oracle/admin/orcl/xdb_wallet))(Presentation=HTTP)(Session=RAW))</span><br><span class="line">Services Summary...</span><br><span class="line">Service &quot;86b637b62fdf7a65e053f706e80a27ca&quot; has 1 instance(s).</span><br><span class="line">  Instance &quot;orcl&quot;, status READY, has 1 handler(s) for this service...</span><br><span class="line">Service &quot;d083de58225c7d4fe0530100007f0ce6&quot; has 1 instance(s).</span><br><span class="line">  Instance &quot;orcl&quot;, status READY, has 1 handler(s) for this service...</span><br><span class="line">Service &quot;orcl&quot; has 1 instance(s).</span><br><span class="line">  Instance &quot;orcl&quot;, status READY, has 1 handler(s) for this service...</span><br><span class="line">Service &quot;orclXDB&quot; has 1 instance(s).</span><br><span class="line">  Instance &quot;orcl&quot;, status READY, has 1 handler(s) for this service...</span><br><span class="line">Service &quot;orclpdb&quot; has 1 instance(s).</span><br><span class="line">  Instance &quot;orcl&quot;, status READY, has 1 handler(s) for this service...</span><br><span class="line">The command completed successfully</span><br></pre></td></tr></table></figure><h1 id="3-安装Oracle-Client"><a href="#3-安装Oracle-Client" class="headerlink" title="3. 安装Oracle Client"></a>3. 安装Oracle Client</h1><h2 id="3-1-下载Oracle-Client"><a href="#3-1-下载Oracle-Client" class="headerlink" title="3.1 下载Oracle Client"></a>3.1 下载Oracle Client</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https://download.oracle.com/otn_software/linux/instantclient/199000/oracle-instantclient19.9-basic-19.9.0.0.0-1.x86_64.rpm</span><br><span class="line">wget https://download.oracle.com/otn_software/linux/instantclient/199000/oracle-instantclient19.9-sqlplus-19.9.0.0.0-1.x86_64.rpm</span><br><span class="line">wget https://download.oracle.com/otn_software/linux/instantclient/199000/oracle-instantclient19.9-devel-19.9.0.0.0-1.x86_64.rpm</span><br><span class="line">wget https://download.oracle.com/otn_software/linux/instantclient/199000/oracle-instantclient19.9-odbc-19.9.0.0.0-1.x86_64.rpm</span><br></pre></td></tr></table></figure><h2 id="3-2-安装Oracle-Client"><a href="#3-2-安装Oracle-Client" class="headerlink" title="3.2 安装Oracle Client"></a>3.2 安装Oracle Client</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum -y install unixODBC unixODBC-devel</span><br><span class="line">yum localinstall oracle-instantclient19.9-*</span><br><span class="line"></span><br><span class="line">[root@db132 ~]# find / -name client64</span><br><span class="line">/usr/lib/oracle/19.9/client64</span><br><span class="line">/usr/share/oracle/19.9/client64</span><br><span class="line">/usr/include/oracle/19.9/client64</span><br></pre></td></tr></table></figure><h2 id="3-3-配置SqlPlus连接扩展"><a href="#3-3-配置SqlPlus连接扩展" class="headerlink" title="3.3 配置SqlPlus连接扩展"></a>3.3 配置SqlPlus连接扩展</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#使用root账号操作</span><br><span class="line"></span><br><span class="line">mkdir -p /usr/lib/oracle/19.9/client64/network/admin</span><br><span class="line">vim /usr/lib/oracle/19.9/client64/network/admin/tnsnames.ora</span><br><span class="line"></span><br><span class="line">#添加如下内容</span><br><span class="line">db132_oracle=</span><br><span class="line">   (DESCRIPTION =</span><br><span class="line">     (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.111.132)(PORT = 1521))</span><br><span class="line">     (CONNECT_DATA =</span><br><span class="line">        (SERVER = DEDICATED)</span><br><span class="line">        (SERVICE_NAME = ORCL)</span><br><span class="line">     )</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><h2 id="3-4-配置环境变量"><a href="#3-4-配置环境变量" class="headerlink" title="3.4 配置环境变量"></a>3.4 配置环境变量</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#添加以下内容到/etc/profile文件末尾</span><br><span class="line">vim /etc/profile</span><br><span class="line">export ORACLE_HOME=/usr/lib/oracle/19.9/client64</span><br><span class="line">export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/usr/lib64:$LD_LIBRARY_PATH</span><br><span class="line">export TNS_ADMIN=$ORACLE_HOME/network/admin</span><br><span class="line">export PATH=$PATH:$ORACLE_HOME/bin:$HOME/binsource </span><br></pre></td></tr></table></figure><h2 id="3-5-配置lib库软连接"><a href="#3-5-配置lib库软连接" class="headerlink" title="3.5 配置lib库软连接"></a>3.5 配置lib库软连接</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /usr/lib/oracle/19.9/client64/lib/libsqora.so.19.1</span><br><span class="line">cd /usr/lib64/</span><br><span class="line">ln -s libodbcinst.so.2.0.0  libodbcinst.so.1	</span><br></pre></td></tr></table></figure><h2 id="3-6-添加Oracle驱动"><a href="#3-6-添加Oracle驱动" class="headerlink" title="3.6 添加Oracle驱动"></a>3.6 添加Oracle驱动</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/odbcinst.ini</span><br><span class="line"># 添加以下内容到文件末尾</span><br><span class="line">[oracle]</span><br><span class="line">Description     = Oracle ODBC driver for Oracle 19c</span><br><span class="line">Driver          = /usr/lib/oracle/19.9/client64/lib/libsqora.so.19.1</span><br></pre></td></tr></table></figure><h2 id="3-7-添加odbc连接"><a href="#3-7-添加odbc连接" class="headerlink" title="3.7 添加odbc连接"></a>3.7 添加odbc连接</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/odbc.ini</span><br><span class="line"># 添加以下内容</span><br><span class="line">[db132]</span><br><span class="line">Driver = Oracle</span><br><span class="line">ServerName = 192.168.111.132:1521/ORCLPDB</span><br><span class="line">UserID = zabbix_mon</span><br><span class="line">Password = zabbix_mon</span><br></pre></td></tr></table></figure><h2 id="3-8-进行ISQL测试"><a href="#3-8-进行ISQL测试" class="headerlink" title="3.8 进行ISQL测试"></a>3.8 进行ISQL测试</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#验证是否配置成功</span><br><span class="line">sql -v db132  #名称为odbc.ini中定义的连接名称 </span><br><span class="line">sqlplus 用户名/密码@IP/oracle数据库服务名 #如sqlplus system/xxxx@IP:1521/cdb1</span><br></pre></td></tr></table></figure><p><img src="/images/2021/1116/01.png" alt="01"></p><h1 id="4-Zabbix-WEB操作"><a href="#4-Zabbix-WEB操作" class="headerlink" title="4. Zabbix WEB操作"></a>4. Zabbix WEB操作</h1><p><img src="/images/2021/1116/02.png" alt="01"></p><p><img src="/images/2021/1116/03.png" alt="01"></p><p><img src="/images/2021/1116/04.png" alt="01"><br>在最新数据里查看相关信息<br><img src="/images/2021/1116/05.png" alt="01"></p><p>参考链接：<a target="_blank" rel="noopener" href="https://bbs.huaweicloud.com/blogs/249319">https://bbs.huaweicloud.com/blogs/249319</a></p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/zabbix/" rel="tag"># zabbix</a> <a href="/tags/%E7%9B%91%E6%8E%A7/" rel="tag"># 监控</a></div><div class="post-nav"><div class="post-nav-item"><a href="/arlo/65cdd712/" rel="prev" title="源码安装PostgreSQL数据库"><i class="fa fa-chevron-left"></i> 源码安装PostgreSQL数据库</a></div><div class="post-nav-item"><a href="/arlo/3449ffc7/" rel="next" title="二进制安装Mysql5.7.31">二进制安装Mysql5.7.31 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener("tabs:register",()=>{let{activeClass:t}=CONFIG.comments;if(CONFIG.comments.storage&&(t=localStorage.getItem("comments_active")||t),t){let e=document.querySelector(`a[href="#comment-${t}"]`);e&&e.click()}}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{if(!t.target.matches(".tabs-comment .tab-content .tab-pane"))return;let e=t.target.classList[1];localStorage.setItem("comments_active",e)})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-%E5%AE%89%E8%A3%85Zabbix-Agent2"><span class="nav-number">1.</span> <span class="nav-text">1. 安装Zabbix Agent2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-%E5%AE%89%E8%A3%85Zabbix-Agent2"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 安装Zabbix Agent2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E4%BF%AE%E6%94%B9zabbix-agent2-conf-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 修改zabbix_agent2.conf 配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-%E5%90%AF%E5%8A%A8zabbix-agent2"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 启动zabbix-agent2</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-%E9%85%8D%E7%BD%AEOracle%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">2.</span> <span class="nav-text">2. 配置Oracle数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-%E5%90%AF%E5%8A%A8PDB"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 启动PDB</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-%E6%96%B0%E5%BB%BAOracle-%E7%9B%91%E6%8E%A7%E8%B4%A6%E5%8F%B7"><span class="nav-number">2.2.</span> <span class="nav-text">2.1 新建Oracle 监控账号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-%E6%9F%A5%E7%9C%8B%E7%9B%91%E5%90%AC%E7%8A%B6%E6%80%81"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 查看监听状态</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-%E5%AE%89%E8%A3%85Oracle-Client"><span class="nav-number">3.</span> <span class="nav-text">3. 安装Oracle Client</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-%E4%B8%8B%E8%BD%BDOracle-Client"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 下载Oracle Client</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-%E5%AE%89%E8%A3%85Oracle-Client"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 安装Oracle Client</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-%E9%85%8D%E7%BD%AESqlPlus%E8%BF%9E%E6%8E%A5%E6%89%A9%E5%B1%95"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 配置SqlPlus连接扩展</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="nav-number">3.4.</span> <span class="nav-text">3.4 配置环境变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-%E9%85%8D%E7%BD%AElib%E5%BA%93%E8%BD%AF%E8%BF%9E%E6%8E%A5"><span class="nav-number">3.5.</span> <span class="nav-text">3.5 配置lib库软连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6-%E6%B7%BB%E5%8A%A0Oracle%E9%A9%B1%E5%8A%A8"><span class="nav-number">3.6.</span> <span class="nav-text">3.6 添加Oracle驱动</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-7-%E6%B7%BB%E5%8A%A0odbc%E8%BF%9E%E6%8E%A5"><span class="nav-number">3.7.</span> <span class="nav-text">3.7 添加odbc连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-8-%E8%BF%9B%E8%A1%8CISQL%E6%B5%8B%E8%AF%95"><span class="nav-number">3.8.</span> <span class="nav-text">3.8 进行ISQL测试</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-Zabbix-WEB%E6%93%8D%E4%BD%9C"><span class="nav-number">4.</span> <span class="nav-text">4. Zabbix WEB操作</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="南山小樵" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">南山小樵</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">180</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">17</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">104</span> <span class="site-state-item-name">标签</span></a></div></nav></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">南山小樵</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script></body></html>